import pg from 'pg';

export type UpdateMytable1Data = {
	value?: number | null;
}

export type UpdateMytable1Params = {
	id: number;
}

export type UpdateMytable1Result = {
	id: number;
	value: number | null;
}

export async function updateMytable1(client: pg.Client | pg.Pool | pg.PoolClient, data: UpdateMytable1Data, params: UpdateMytable1Params): Promise<UpdateMytable1Result | null> {
	const updateColumns = ['value'] as const;
	const updates: string[] = [];
	const values: unknown[] = [];
	let parameterNumber = 1;

	for (const column of updateColumns) {
		const value = data[column];
		if (value !== undefined) {
			updates.push(`${column} = $${parameterNumber++}`);
			values.push(value);
		}
	}
	if (updates.length === 0) return null;
	values.push(params.id);

	const sql = `UPDATE mytable1 SET ${updates.join(', ')} WHERE id = $${parameterNumber} RETURNING *`;
	return client.query({ text: sql, values })
		.then(res => res.rows[0] ?? null);
}